\documentclass{article}

\usepackage[margin=2.5cm,left=2cm,includefoot]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage[space]{grffile}
\usepackage{hyperref}
\usepackage[export]{adjustbox}
\usepackage{multicol}
\usepackage{caption}
\usepackage{hyperref}
\usepackage{listings}

\usepackage{titlesec}

\setcounter{secnumdepth}{4}

\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

% Header and footer
\usepackage{fancyhdr}
\pagestyle{fancy}

\rhead{COS301}
\lhead{Non-Functional Requirements}
\fancyfoot[R]{Page \thepage}

\renewcommand{\headrulewidth}{2pt}
\renewcommand{\footrulewidth}{1pt}

\begin{document}

	\begin{titlepage}
		\begin{center}
		
			\line(1,0){300}\\
			[6mm]
			\huge{
			Non-Functional Requirements\\
			}
			
			\line(1,0){300}\\
			\huge{Project: Insurance profiling from social media\\
			Client: RetroRabbit} \\
			\line(1,0){300}\\
			\huge{Team: Valknut Solutions}
			
			\large
			{
			\begin{itemize}
			
				\item 13054903 - Charl Jansen van Vuuren 
				\item 10297902 - Bernhard Schuld      
				\item 13044924 - Kevin Heritage
				\item 13176545 - Quinton Weenink
			\end{itemize}
			}
		\textsc{\large  Department of Computer Science, University of Pretoria}\\
		[0.5cm]
		\textsc{\large Date}	
		\end{center}

		%\begin{figure}[H]}
		%\centering
		%\includegraphics[{imagename}
		%\end{figure}\
			
	\end{titlepage}
	\cleardoublepage
	\tableofcontents
	\cleardoublepage
\section{Introduction}
This document contains information on the development of a system to generate insurance profiles based on social media inputs. The project is being developed for Retrorabbit as part of the COS301 module at the University Of Pretoria.
\section{Vision}
The primary focus of this project is to generate quick, reliable insurance/risk profiles from user's social media information. The profile generated will be ideally used for portable possession insurance (cellphones, laptops, purses). Insurance profiling and risk analysis often require large amounts of data to generate in-depth profiles, our project seek the means to eliminate the need for vast amounts of data gathering by using a user's social media information. A user would log into our system, provide the necessary permissions and our engine will generate a risk profile for that person based on certain criteria. The generated profile can assist insurers to create more accurate risk profiles or clients to get personally tailored quotes, instantly.
\section{Scope of system}
The system will primarily be web-based. A user visiting the website will request a quote and be prompted to log into Facebook. A service will then acquire data from the userâ€™s Facebook profile. This data will be fed into the profiling engine, which will process the data to create a risk profile. This risk profile will be used to generate a quote, which will then be displayed to the user on the website.

\section{Architectural requirements}
	\subsection{Access channel requirements}
	\begin{enumerate}
		\item A user would log in to the system via a Facebook Login button hosted on our website. The Facebook login is achieved via a REST api call to Facebook's servers.
		\item The login dialogue will ask the user to log into their Facebook account and will redirect to a permission request afterwards. The permission request specifies which data the system will gather from the user's Facebook account.
		\item The necessary data will be gathered and analysed (by the system).
		\item A report will be generated which will be displayed to the user via a web page.
		\item Further options will be accessible via this web page. 
		\item The integration with Facebook advertisements will also be considered as this forms part of a different subset of access to the system, not through our website, but through the user's Facebook dashboard.
	\end{enumerate}
	Further access channel specification include:
	\begin{itemize}
		\item The website will be accessible and optimized for all web-browsers including mobile phone browsers.
		\item The possibility of developing a mobile application will be considered as per the client's request.
		\item The website will be accessible via the majority of operating system if such an operating system has access to a supported web-browser.
		\item Facebook advertisement integration will be accessible via the normal Facebook access channels.
	\end{itemize}
	 
	
	\subsection{Quality requirements}
		\subsubsection{Performance}
		\begin{itemize}
			\item The user should be able to request a quote in less than 5 minutes, this is easily achieved by means of the Facebook login and will only be user-network dependent.
			\item Once the REST API call is made it saves the users data in our database, increasing the efficiency of future requests and processing of the data.
		\end{itemize}
		 
		\subsubsection{Security}
		\begin{itemize}
			\item Security is our most important architectural requirement. User's personal information is used to generate these risk profiles and as a result the user will trust that this information is not shared with other parties.
			\item Only authorized persons will have access to the generated profile and access to the database will need to be restricted to the highest authority.
		\end{itemize}
		\subsubsection{Scalability}
		\begin{itemize}
			\item Since this project is a web-solution the possibility of multiple concurrent users should be considered.
			\item The server should account for a vast amount of concurrent users.
			\item As per integrability, The ability to change the risk analysis algorithm as needed should be considered to a future scalable solution.
		\end{itemize}

		\subsubsection{Integrability}
		\begin{itemize}
			\item The project will integrate with Facebook mainly as the primary data provider.
			\item A Facebook approved login button on our website will allow access to the information requested. 
			\item The ability to integrate with other social media should be considered and modularized accordingly as to ensure future integration of other social media platforms. 
		\item The ability to change the risk analysis algorithm as needed should be considered.
		\item Integration includes the connection from the website to the profiling engine and back to the website as a report.
		\item Further integration might include the use of Facebook's advertisements. Instead of logging into our website the user will be able to generate a report directly from their Facebook dashboard.
		\end{itemize}		
		\subsubsection{Reliability}
		Since our platform is mainly web-based the platform as a service (PaaS) offered by Heroku hosting will ensure the website is always up to date and reliable.
		\subsubsection{Maintainability}
		The system will make use of a database with massive amounts of data, to ensure optimal performance this data will need to be maintained and normalised on a regular basis.
		\subsubsection{Auditability}
		\begin{itemize}
			\item All actions performed in the system should be traceable to the user that performed them.
			\item The user's IP  will be logged as to have a form of accountability in the persistence of the data.
		\end{itemize}
		\subsubsection{Cost}
		The majority of our platform is open-source except for:
		\begin{itemize}
			\item Heroku hosting if the commercial version is used
			\item Travis CI if commercial version is used
		\end{itemize}
		\subsubsection{Usability}
		\begin{itemize}
			\item The platform is being developed with efficiency in mind, as a result the input and response of the website should be visually pleasing and simple to use.
			\item The Facebook login API aims to improve efficiency for the user as this eliminates the need to fill various fields into a form for example.
			\item Further integration with the Facebook ad system will increase usability even more as the user will be able to generate a report from their Facebook dashboard, without the need to log in to our website.
		\end{itemize}
		 



	\subsection{Integration requirements}
		\subsubsection{API specifications}
			The use of API will be the API provided by Facebook. Depending on which technology our client requires us to use we will use the Facebook API for that technology.

			Facebook has APIs for almost every technology/language. If they do not have an API for that technology/language they refer you to third party plugins for the technology or language that you want to use.

			There is always the method of using the standard HTTP web request to gain access to the Facebook servers. The only thing left in this method of interacting with the API will be to parse the JSON string that will be returned by the Facebook server. It is also possible to get the access token using this method (a string of characters giving you access to a persons facebook account with the permissions specified).

			Regarding the access token a User Access Token should be used. This User Access Token should also have the longest lifetime possible to be able to update user data for as long as possible.

			Seeing as we are using technologies that do not support the SDKs (Android, IOS, Javascript) we will be building a login flow with the use of \href{https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow}{redirects}.\\

			Building a login flow
			\begin{itemize}
				\item \href{https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow#checklogin}{Check login status}
					\begin{itemize}
						\item Have to create own way of checking if a user is logged in (ie. an indicator)
						\item When there is no indicator user is presumed to be logged out.
						\item If user is logged out it should ask them to log back in.
					\end{itemize}
				\item \href{https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow#login}{Logging peopole in}
					\begin{itemize}
						\item Invoking the login dialog
							\begin{itemize}
								\item
									\begin{verbatim}
									https://www.facebook.com/dialog/oauth?
									client_id={app-id}
									&redirect_uri={redirect-uri}
									&response_type=code&state={app-generated-string}
									\end{verbatim}
								\item Extra parameter to look into will be to add the `state' parameter to guard against Cross-site Request Forgery.
							\end{itemize}
						\item Handling login dialog response
							\begin{itemize}
								\item The access token will be parameters appended to the redirect URL
								\begin{verbatim}
									{redirect-URI}#access_token=ACCESS_TOKEN...
								\end{verbatim}
								\item The access token is then read from the parameters and can be used to fetch the data
							\end{itemize}
						\item Canceled login
							\begin{itemize}
								\item When the user cancels the login process the redirect URI will have these parameteres
								\begin{verbatim}
									REDIRECT_URI?
  									error_reason=user_denied
  									&error=access_denied
  									&error_description=The+user+denied+your+request.
								\end{verbatim}
							\end{itemize}
					\end{itemize}

				\item \href{https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow#confirm}{Confirming identity}
					\begin{itemize}
						\item Because we are using redirects of URLs, the data could be tampered with on the client network (insecure WiFi network) \& made-up fragments or parameters can be recieved.
						\item Need to confirm the response came from the same user we were talking to.
						\item The 'code' that we recieve will have to be exchanged for an access token to the users profile.
							\begin{verbatim}
								https://graph.facebook.com/v2.3/oauth/access_token?
    								client_id={app-id}
   									&redirect_uri={redirect-uri}
   									&client_secret={app-secret}
   									&code={code-parameter}
							\end{verbatim}
						Response recieved if successful is:
							\begin{verbatim}
								{
								  "access_token": {access-token}, 
								  "token_type": 	{type},
								  "expires_in":	{seconds-til-expiration}
								}
							\end{verbatim}
					\end{itemize}
				\item \href{https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow#token}{Storing access tokens \& login status}
					\begin{itemize}
						\item At this point we can make API calls on behalf of the user to retrieve their data from Facebook.
						\item At this step we should save the users access token to be able to refresh their data at intervals.
					\end{itemize}
				\item \href{https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow#logout}{Logging people out}
					\begin{itemize}
						\item When we log out the user from Facebook for any reason we should delete the access token from the database as it will become useless to us.
					\end{itemize}
				\item On a side not we should never reveal our App-secret to the user. It should only be used on the server side.
			\end{itemize}

			\href{https://developers.facebook.com/docs/facebook-login/access-tokens}{Access Tokens}
			\begin{itemize}
				\item The access tokens generated via web logins are short lived but one can convert them to long lived tokens.
				\item Apps with Standard access to Facebook's Marketing API when using long-lived tokens will recieve long-lived tokens that don't have an expiry time.
				\item For security to validate some data we may need to gain App access tokens. These tokens are only for the developers of the application not for general public.
				\item To generate an app access token:
					\begin{verbatim}
						/oauth/access_token?
					     client_id={app-id}
					    &amp;client_secret={app-secret}
					    &amp;grant_type=client_credentials
					\end{verbatim}
				\item Once again the app secret should be kept safe and hidden from users
			\end{itemize}

		\subsubsection{Protocols}
		The system will include the use of these protocols:
		\begin{itemize}
			\item HTTP/HTTPS - (Secure) Hypertext Transfer Protocol
			\item TCP/IP - Transmission Control Protocol/ Internet Protocol
			\item FTP(Possibly) - File Transfer Protocol
			\item SSL - Secure Socket Layer 
		\end{itemize}
		The request for comment pages of these protocols can be accessed via:
		\begin{itemize}
			\item\href{https://tools.ietf.org/html/rfc2616}{HTTP}
			\item\href{https://tools.ietf.org/html/rfc2660}{HTTPS}
			\item\href{https://www.ietf.org/rfc/rfc793.txt}{TCP}
			\item\href{http://www.ietf.org/rfc/rfc0791.txt}{IP}
			\item\href{https://www.ietf.org/rfc/rfc959.txt}{FTP}
			\item\href{https://tools.ietf.org/html/rfc6101}{SSL}
		\end{itemize}
		\subsubsection{Integration Quality Requirements}

	
	\subsection{Architecture Constraints}
	Our client limited our technologies to:
	\begin{itemize}
		\item An ASP.net web solution with a Microsoft SQL Server database system.
		\item A NodeJS web solution with a PostgreSQL database system.
		\item The use of a platform as a services (PaaS) hosting solution, Heroku.
		\item We have the freedom to use the Facebook SDK in any language except for PHP as mentioned below.
	\end{itemize}
	Our client specifically constrained the use of:
		\begin{itemize}
		\item PHP code in any way.
		\item MySQL, NoSQL database systems.
		\end{itemize}	
	Other constraints in terms of architecture include:
	\begin{itemize}
		\item Browser independence as to ensure any web-client can make use thereof.
		\item Operating system independent.
		\item The system should be as time efficient as possible to ensure a user gets a quote in less than 5 minutes.
		\end{itemize}
	
	
	\section{Initial Architecture Design}

%\section{Functional Requirements}

%	\subsection{Use case name}
%		\subsubsection{Use case prioritization}
%		\subsubsection{Use case service contracts}
%		\subsubsection{Process specification}
	
%	\subsection{Domain model}
%	\subsection{Open Issues}


	

\end{document}
